<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Company List</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Custom font with fallback -->
  <link href="https://fonts.cdnfonts.com/css/neue-haas-grotesk-display-pro" rel="stylesheet" />
  <style>
    html, body {
      font-family: 'Neue Haas Grotesk Display Pro', Arial, sans-serif;
      background-color: #282828;
      color: white;
      margin: 0;
      padding: 10px;
      width: 880px;
      height: 800px;
      overflow: hidden;
    }

    #companyList {
      height: 700px;
      overflow: hidden;
    }

    .row {
      display: block;
      padding: 4px;
      border-bottom: 1px solid #444;
      font-size: 32px;
      line-height: 36px;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    .footer {
      background-color: #ff6600;
      color: white;
      text-align: center;
      padding: 10px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      width: 100%;
      font-size: 15px;
      font-weight: bold;
      box-sizing: border-box;
    }

    .fade-out { filter: alpha(opacity=0); opacity: 0; }
    .fade-in  { filter: alpha(opacity=100); opacity: 1; }

    /* IE fallback */
    img {
      border: 0;
    }

    /* Simple responsive fallback */
    @media screen and (max-width: 600px) {
      .row { font-size: 22px; line-height: 28px; }
      .footer { font-size: 13px; }
    }
  </style>
</head>
<body>
  <div id="companyList">Loading...</div>
  <div class="footer" id="footer">Loading... | Page 1 of 1</div>

  <script>
    var dataUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSHIT3SeyUDvm1vUXuo5xdZJwrFlYkBPR-P4ebecZ1KgJy0LGhHU2QRoHz0pSN2L238rd2IH2_zA0PD/pubhtml?gid=0&single=true";
    var companies = [];
    var currentPage = 0;
    var targetCompaniesPerPage = 10;
    var totalPages = 1;
    var sheetTitle = "Company List";
    var pageBreaks = [0];

    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
      if (xhr.readyState === 4) {
        if (xhr.status === 200) {
          var temp = document.createElement("div");
          temp.innerHTML = xhr.responseText;

          var titleElement = temp.getElementsByTagName("title")[0];
          if (titleElement && titleElement.innerText) {
            sheetTitle = titleElement.innerText.replace(/ - Google .*$/, "").replace(/^\s+|\s+$/g, "");
            document.title = sheetTitle;
          }

          var table = temp.getElementsByTagName("table")[0];
          if (!table) {
            document.getElementById("companyList").innerText = "Error: No table found in the Google Sheet.";
            document.getElementById("footer").innerText = sheetTitle + " | Page 1 of 1";
            return;
          }

          var rows = table.rows;
          companies = [];
          for (var i = 1; i < rows.length; i++) {
            var cells = rows[i].cells;
            if (cells.length < 2) { continue; }
            var listNumber = cells[0] ? cells[0].innerText.replace(/^\s+|\s+$/g, "") : i.toString();
            var companyName = cells[1] ? cells[1].innerText.replace(/^\s+|\s+$/g, "") : "Unnamed";
            companies.push({ listNumber: listNumber, companyName: companyName });
          }

          pageBreaks = [0];
          for (var j = 0; j < companies.length; j += targetCompaniesPerPage) {
            pageBreaks.push(Math.min(j + targetCompaniesPerPage, companies.length));
          }
          totalPages = pageBreaks.length - 1;

          displayPage(currentPage);
          updateFooter();
          startAutoTransition();
        } else {
          document.getElementById("companyList").innerText = "Error loading data (Status: " + xhr.status + ")";
        }
      }
    };
    xhr.open("GET", dataUrl, true);
    try {
      xhr.send();
    } catch (e) {
      document.getElementById("companyList").innerText = "Error sending request.";
    }

    function displayPage(page) {
      var companyList = document.getElementById("companyList");
      companyList.className = "fade-out";

      setTimeout(function() {
        var start = pageBreaks[page];
        var end = pageBreaks[page + 1] || companies.length;
        var output = "";

        for (var k = start; k < end && k < start + targetCompaniesPerPage; k++) {
          output += '<div class="row">' + companies[k].listNumber + ". " + companies[k].companyName + "</div>";
        }

        for (var k = end - start; k < targetCompaniesPerPage; k++) {
          output += '<div class="row"> </div>';
        }

        companyList.innerHTML = output;
        companyList.className = "fade-in";
        updateFooter();
      }, 500);
    }

    function updateFooter() {
      document.getElementById("footer").innerText = sheetTitle + " | Page " + (currentPage + 1) + " of " + totalPages;
    }

    function startAutoTransition() {
      setInterval(function() {
        currentPage = (currentPage + 1) % totalPages;
        displayPage(currentPage);
      }, 15000);
    }
  </script>
</body>
</html>
