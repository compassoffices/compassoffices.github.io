<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/png" href="https://www.compassoffices.com/wp-content/uploads/2025/09/compassoffices-logo-web-2025_icon-o-scaled.png">
<title>Compass Events - Hong Kong</title>
<meta property="og:title" content="Compass Events - Hong Kong">
<meta property="og:description" content="Upcoming events and schedules in Hong Kong">
<meta property="og:image" content="https://via.placeholder.com/1200x630.png?text=Compass+Events+Hong+Kong">
<meta property="og:url" content="https://www.compassoffices.com/events-hongkong"> <!-- Replace with actual URL -->
<style>
body {
  box-sizing: border-box;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background: #f8f8f8;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}
.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
  flex: 1;
}
.logo-banner {
  width: 100%;
  background: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 16px 0;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  position: sticky;
  top: 0;
  z-index: 10;
}
.logo-banner img {
  height: 50px;
  width: auto;
}
.header {
  background: #fff;
  color: #333;
  padding: 20px;
  text-align: center;
  border-radius: 12px;
  margin-bottom: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  position: relative;
}
.header h1 {
  margin: 0 0 5px 0;
  font-size: 2rem;
  font-weight: 700;
}
.header p {
  margin: 5px 0 0 0;
  font-size: 1rem;
  color: #ff6600;
  font-weight: 600;
}
.event-count {
  margin: 10px 0 0 0;
  font-size: 1rem;
  color: #666;
}
.filter-toggle {
  position: absolute;
  top: 20px;
  right: 20px;
  background: none;
  border: none;
  cursor: pointer;
  color: #ff6600;
  font-size: 1.5rem;
}
.selector-group {
  display: none;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin: 20px 0;
}
.selector-group.visible {
  display: flex;
}
.selector-group label {
  display: none; /* Hide labels for app-like minimalism */
}
.selector-group select {
  background: #fff;
  border: 1px solid #ddd;
  color: #333;
  padding: 12px 16px;
  border-radius: 30px;
  font-size: 1rem;
  flex: 1;
  min-width: 120px;
  max-width: 200px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  outline: none;
  transition: all 0.3s;
}
.selector-group select:focus,
.selector-group select:hover {
  border-color: #ff6600;
  box-shadow: 0 2px 8px rgba(255,102,0,0.2);
}
.search-group {
  margin: 10px 0;
}
.search-group input {
  background: #fff;
  border: 1px solid #ddd;
  color: #333;
  padding: 12px 16px;
  border-radius: 30px;
  font-size: 1rem;
  width: 100%;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  outline: none;
  transition: all 0.3s;
}
.search-group input:focus,
.search-group input:hover {
  border-color: #ff6600;
  box-shadow: 0 2px 8px rgba(255,102,0,0.2);
}
.loading,
.no-events {
  text-align: center;
  padding: 40px 20px;
  color: #666;
  font-size: 1.1rem;
}
.spinner {
  border: 4px solid #eee;
  border-top: 4px solid #ff6600;
  border-radius: 50%;
  width: 30px;
  height: 30px;
  animation: spin 1s linear infinite;
  margin: 0 auto 15px;
}
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
.events-container {
  display: flex;
  flex-direction: column;
  gap: 15px;
}
.event-card {
  background: #fff;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  transition: transform 0.3s, box-shadow 0.3s;
  border-left: 4px solid #ff6600;
}
.event-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 16px rgba(0,0,0,0.1);
}
.event-card.today {
  border-left-color: #ff6b6b;
}
.event-card.upcoming {
  border-left-color: #51cf66;
}
.event-date {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
  font-size: 0.9rem;
  color: #666;
}
.date-badge {
  background: #ff6600;
  color: #fff;
  padding: 6px 12px;
  border-radius: 20px;
  font-weight: 600;
  margin-right: 10px;
}
.today .date-badge { background: #ff6b6b; }
.upcoming .date-badge { background: #51cf66; }
.time-badge {
  background: #eee;
  color: #333;
  padding: 6px 12px;
  border-radius: 20px;
}
.event-title {
  font-size: 1.2rem;
  font-weight: 700;
  color: #333;
  margin-bottom: 8px;
}
.event-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
  font-size: 0.95rem;
  color: #555;
}
.detail-item {
  display: flex;
  align-items: center;
}
.detail-icon {
  width: 18px;
  height: 18px;
  margin-right: 8px;
  color: #ff6600;
}
.error-message {
  background: #ffe6e6;
  color: #d63031;
  padding: 15px;
  border-radius: 8px;
  margin: 20px 0;
}
@media (min-width: 601px) {
  .events-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
  }
  .selector-group {
    justify-content: flex-start;
  }
  .selector-group select {
    max-width: 150px;
  }
  .search-group input {
    max-width: 400px;
    margin: 0 auto;
    display: block;
  }
}
@media (max-width: 600px) {
  .container { padding: 10px; }
  .logo-banner img { height: 40px; }
  .header { padding: 15px; margin-bottom: 0; border-radius: 0; box-shadow: none; }
  .selector-group { flex-direction: column; gap: 8px; }
  .selector-group select { max-width: none; }
  .event-card { padding: 15px; }
  .filter-toggle { top: 15px; right: 15px; font-size: 1.3rem; }
  .events-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  .search-group {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: #f8f8f8;
    padding: 10px;
    box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
    z-index: 9;
    margin: 0;
  }
  .search-group input {
    border-radius: 30px;
    padding: 14px 20px;
    font-size: 1.1rem;
  }
  main.container {
    padding-bottom: 70px; /* Space for fixed search bar */
  }
}
</style>
</head>
<body>
<main class="container">
<div class="logo-banner">
<img src="https://www.compassoffices.com/wp-content/themes/compass-offices/assets/images/new-p1-02.png"
alt="Compass Offices Logo" />
</div>
<header class="header">
<h1>Hong Kong Events</h1>
<p>Upcoming events and schedules</p>
<div id="event-count" class="event-count">Loading events...</div>
<button id="filter-toggle" class="filter-toggle">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 4C3 3.44772 3.44772 3 4 3H20C20.5523 3 21 3.44772 21 4V6.58579C21 6.851 20.8946 7.10536 20.7071 7.29289L15 13V20C15 20.3788 14.786 20.7144 14.4472 20.8944C14.1084 21.0745 13.7023 21.0676 13.3716 20.8801L10.3716 19.1199C10.1452 18.9934 10 18.7671 10 18.5192V13L3.29289 6.29289C3.10536 6.10536 3 5.851 3 5.58579V4Z" fill="currentColor"/>
</svg>
</button>
<div id="selector-group" class="selector-group">
<select id="year-select">
<option value="all">All Years</option>
</select>
<select id="month-select">
<option value="all">All Months</option>
<option value="0">January</option>
<option value="1">February</option>
<option value="2">March</option>
<option value="3">April</option>
<option value="4">May</option>
<option value="5">June</option>
<option value="6">July</option>
<option value="7">August</option>
<option value="8">September</option>
<option value="9">October</option>
<option value="10">November</option>
<option value="11">December</option>
</select>
<select id="company-select">
<option value="all">All Companies</option>
</select>
</div>
</header>
<div id="loading" class="loading">
<div class="spinner"></div>
<p>Loading events...</p>
</div>
<div id="events-container" class="events-container" style="display: none;"></div>
<div id="error-container" style="display: none;">
<div class="error-message">
<h3>Unable to load events</h3>
<p>There was an issue fetching data from the Google Sheet. Please check the sheet URL and try again.</p>
</div>
</div>
<div class="search-group">
<input type="text" id="search-input" placeholder="Search events...">
</div>
</main>
<script>
function getCSVUrl() {
  const spreadsheetId = '1vTazGFKOEPVQu77BpCHV9rTo8odUfVeH7_k0xLjio7V4bUXw__hk14JMBJu0iDC3MewNy8Hw3kowOJt';
  const gid = '1632866699';
  return `https://docs.google.com/spreadsheets/d/${spreadsheetId}/export?format=csv&gid=${gid}`;
}
function parseCSV(csvText) {
  const lines = csvText.split('\n');
  const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
  const data = [];
  for (let i = 1; i < lines.length; i++) {
    if (lines[i].trim()) {
      const values = parseCSVLine(lines[i]);
      const row = {};
      headers.forEach((header, index) => {
        row[header] = values[index] || '';
      });
      data.push(row);
    }
  }
  return data;
}
function parseCSVLine(line) {
  const result = [];
  let current = '';
  let inQuotes = false;
  for (let i = 0; i < line.length; i++) {
    const char = line[i];
    if (char === '"') {
      inQuotes = !inQuotes;
    } else if (char === ',' && !inQuotes) {
      result.push(current.trim());
      current = '';
    } else {
      current += char;
    }
  }
  result.push(current.trim());
  return result;
}
function parseDate(dateStr) {
  if (!dateStr) return null;
  const formats = [
    /(\d{1,2})\/(\d{1,2})\/(\d{4})/,
    /(\d{4})-(\d{1,2})-(\d{1,2})/,
    /(\d{1,2})-(\d{1,2})-(\d{4})/
  ];
  for (const format of formats) {
    const match = dateStr.match(format);
    if (match) {
      if (format === formats[0]) return new Date(match[3], match[2] - 1, match[1]);
      else if (format === formats[1]) return new Date(match[1], match[2] - 1, match[3]);
      else return new Date(match[3], match[1] - 1, match[2]);
    }
  }
  const date = new Date(dateStr);
  return isNaN(date.getTime()) ? null : date;
}
function isToday(date) {
  const today = new Date();
  return date.toDateString() === today.toDateString();
}
function isUpcoming(date) {
  const today = new Date(); today.setHours(0, 0, 0, 0);
  const eventDate = new Date(date); eventDate.setHours(0, 0, 0, 0);
  return eventDate >= today;
}
function getCurrentMonth() {
  return new Date().getMonth();
}
function getCurrentYear() {
  return new Date().getFullYear();
}
function formatDate(date) {
  return date.toLocaleDateString('en-US', {
    weekday: 'short',
    year: 'numeric',
    month: 'short',
    day: 'numeric'
  });
}
function createEventCard(event, eventDate) {
  const todayClass = isToday(eventDate) ? 'today' : (isUpcoming(eventDate) ? 'upcoming' : '');
  const dateLabel = isToday(eventDate) ? 'Today' : formatDate(eventDate);
  return `
    <div class="event-card ${todayClass}">
      <div class="event-date">
        <span class="date-badge">${dateLabel}</span>
        ${event.Time ? `<span class="time-badge">${event.Time}</span>` : ''}
      </div>
      <div class="event-title">${event['Event-Name'] || 'Untitled Event'}</div>
      <div class="event-details">
        ${event['Client-Name']
          ? `<div class="detail-item">
              <svg class="detail-icon" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
              </svg>
              <span class="detail-text">${event['Client-Name']}</span>
            </div>`
          : ''}
        ${event.Location
          ? `<div class="detail-item">
              <svg class="detail-icon" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
              </svg>
              <span class="detail-text">${event.Location}</span>
            </div>`
          : ''}
      </div>
    </div>
  `;
}
async function loadEvents() {
  const csvUrl = getCSVUrl();
  try {
    let csvText = '';
    let success = false;
    try {
      const response = await fetch(csvUrl, {
        mode: 'cors',
        headers: { 'Accept': 'text/csv,text/plain,*/*' }
      });
      if (response.ok) {
        csvText = await response.text();
        success = true;
      }
    } catch (e) {}
    if (!success) {
      try {
        const altUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTazGFKOEPVQu77BpCHV9rTo8odUfVeH7_k0xLjio7V4bUXw__hk14JMBJu0iDC3MewNy8Hw3kowOJt/pub?gid=1632866699&single=true&output=csv';
        const response = await fetch(altUrl, { mode: 'cors' });
        if (response.ok) {
          csvText = await response.text();
          success = true;
        }
      } catch (e) {}
    }
    if (!success) {
      csvText = `Time,Date,Client-Name,Region,Event-Name,Location,Reception,Details, trigger,Confirmed,Quarter
10:00 AM,01/10/2026,ABC Corp,Hong Kong,Annual Conference,Lee Garden 2, 16/F, Meeting room,Yes,Year-end meeting,Email,Yes,Q1
2:00 PM,01/11/2026,XYZ Ltd,Hong Kong,Product Launch,Lee Garden 2, 16/F, Lounge area,No,New product reveal,Phone,Yes,Q1
9:00 AM,01/12/2026,Tech Solutions,Singapore,Workshop,Some Place,Yes,Training session,Online,Yes,Q1
3:00 PM,01/13/2026,Global Inc,Singapore,Networking Event,Another Place,Yes,Business networking,Email,Yes,Q1`;
      showSampleDataNotice();
    }
    const allEvents = parseCSV(csvText);
    const eventsWithDates = allEvents
      .map(event => ({
        ...event,
        parsedDate: parseDate(event.Date)
      }))
      .filter(event => event.parsedDate && event.Region === 'Hong Kong'); // Filter only Hong Kong
    const uniqueEvents = eventsWithDates.filter((event, index, array) => {
      return index === array.findIndex(e =>
        e['Event-Name'] === event['Event-Name'] &&
        e.Date === event.Date &&
        e.Time === event.Time &&
        e['Client-Name'] === event['Client-Name']
      );
    });
    const sortedEvents = uniqueEvents.sort((a, b) => a.parsedDate - b.parsedDate);
    allEventsData = sortedEvents;
    const uniqueYears = [...new Set(sortedEvents.map(e => e.parsedDate.getFullYear()).filter(y => !isNaN(y)))].sort((a, b) => a - b);
    const yearSelect = document.getElementById('year-select');
    uniqueYears.forEach(year => {
      const option = document.createElement('option');
      option.value = year;
      option.textContent = year;
      yearSelect.appendChild(option);
    });
    yearSelect.value = getCurrentYear();
    const uniqueCompanies = [...new Set(sortedEvents.map(e => e['Client-Name']).filter(c => c))].sort();
    const companySelect = document.getElementById('company-select');
    uniqueCompanies.forEach(company => {
      const option = document.createElement('option');
      option.value = company;
      option.textContent = company;
      companySelect.appendChild(option);
    });
    document.getElementById('month-select').value = getCurrentMonth().toString();
    document.getElementById('year-select').addEventListener('change', filterEvents);
    document.getElementById('month-select').addEventListener('change', filterEvents);
    document.getElementById('company-select').addEventListener('change', filterEvents);
    document.getElementById('search-input').addEventListener('input', filterEvents);
    document.getElementById('filter-toggle').addEventListener('click', () => {
      const group = document.getElementById('selector-group');
      group.classList.toggle('visible');
    });
    filterEvents();
  } catch (error) {
    showError();
  }
}
let allEventsData = [];
function updateEventCount(events) {
  const countEl = document.getElementById('event-count');
  if (events.length === 0) {
    countEl.textContent = 'No events found for the selected filters.';
  } else {
    countEl.textContent = `${events.length} event${events.length === 1 ? '' : 's'}`;
  }
}
function displayEvents(events) {
  document.getElementById('loading').style.display = 'none';
  document.getElementById('events-container').style.display = 'flex';
  const listEl = document.getElementById('events-container');
  updateEventCount(events);
  if (events.length === 0) {
    listEl.innerHTML = `
      <div class="no-events">
        <h3>No events found</h3>
        <p>There are no events for the selected filters.</p>
      </div>
    `;
    return;
  }
  listEl.innerHTML = events.map(event => createEventCard(event, event.parsedDate)).join('');
}
function filterEvents() {
  const selectedYear = document.getElementById('year-select').value;
  const selectedMonth = document.getElementById('month-select').value;
  const selectedCompany = document.getElementById('company-select').value;
  const searchTerm = document.getElementById('search-input').value.toLowerCase();
  let filteredEvents = allEventsData;
  if (selectedYear !== 'all') {
    filteredEvents = filteredEvents.filter(event => event.parsedDate.getFullYear() === parseInt(selectedYear));
  }
  if (selectedMonth !== 'all') {
    filteredEvents = filteredEvents.filter(event => event.parsedDate.getMonth() === parseInt(selectedMonth));
  }
  if (selectedCompany !== 'all') {
    filteredEvents = filteredEvents.filter(event => event['Client-Name'] === selectedCompany);
  }
  if (searchTerm) {
    filteredEvents = filteredEvents.filter(event => 
      (event['Event-Name'] || '').toLowerCase().includes(searchTerm) ||
      (event['Client-Name'] || '').toLowerCase().includes(searchTerm) ||
      (event.Location || '').toLowerCase().includes(searchTerm) ||
      (event.Time || '').toLowerCase().includes(searchTerm)
    );
  }
  filteredEvents.sort((a, b) => {
    const aIsToday = isToday(a.parsedDate);
    const bIsToday = isToday(b.parsedDate);
    const aIsUpcoming = isUpcoming(a.parsedDate);
    const bIsUpcoming = isUpcoming(b.parsedDate);
    if (aIsToday && !bIsToday) return -1;
    if (!aIsToday && bIsToday) return 1;
    if (aIsUpcoming && !bIsUpcoming) return -1;
    if (!aIsUpcoming && bIsUpcoming) return 1;
    return a.parsedDate - b.parsedDate;
  });
  displayEvents(filteredEvents);
}
function showError() {
  document.getElementById('loading').style.display = 'none';
  document.getElementById('error-container').style.display = 'block';
  document.getElementById('events-container').style.display = 'none';
}
function showSampleDataNotice() {
  const header = document.querySelector('.header p');
  header.innerHTML = 'Showing sample data - Please ensure your Google Sheet is publicly accessible';
  header.style.background = 'rgba(255,102,0,0.12)';
  header.style.padding = '10px';
  header.style.borderRadius = '8px';
  header.style.marginTop = '15px';
  header.style.color = '#222';
}
document.addEventListener('DOMContentLoaded', loadEvents);
</script>
</body>
</html>
