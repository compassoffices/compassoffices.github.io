<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Poster</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0; /* Light gray background for preview */
        }

        .poster {
            width: 8.27in; /* A4 width */
            height: 11.69in; /* A4 height */
            background-color: #ffffff; /* White background */
            border: 1px solid #000000; /* Optional border for preview */
            padding: 0.5in; /* Inner margin */
            box-sizing: border-box;
            font-family: Arial, sans-serif;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0,0,0,0.2); /* Shadow for web preview */
        }

        /* Banner at top */
        .banner {
            display: flex;
            align-items: center;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            text-align: left;
            padding: 0.3in 0.5in;
            margin: -0.5in -0.5in 0.5in -0.5in; /* Extend to edges */
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            height: 2in; /* Fixed height for banner */
        }

        .banner-text {
            flex: 1;
            padding-right: 0.2in;
        }

        .banner-text h1 {
            font-size: 1in;
            margin: 0;
        }

        .banner-text h2 {
            font-size: 0.6in;
            margin: 0;
        }

        .banner-image {
            flex: 1;
            text-align: right;
        }

        .banner-image img {
            width: 300px;
            height: 300px;
            object-fit: cover;
            border-radius: 10px;
        }

        /* Box styles (smaller) */
        .box {
            border: 1px solid #cccccc;
            border-radius: 10px;
            padding: 0.2in;
            margin: 0.2in 0;
            background-color: #f9f9f9;
        }

        /* Details list with icons (no header) */
        .details ul {
            list-style: none;
            padding: 0;
            font-size: 0.4in;
            margin: 0;
        }

        .details li {
            margin: 0.05in 0;
        }

        /* Description */
        .description h3 {
            margin: 0 0 0.1in 0;
            font-size: 0.5in;
            text-align: center;
        }

        .description ul {
            list-style-type: disc;
            font-size: 0.3in;
            padding-left: 0.4in;
            margin: 0;
        }

        /* QR box */
        .qr-box {
            position: absolute;
            bottom: 1.5in;
            right: 0.5in;
            width: 150px;
            height: 150px;
            border: 1px solid #cccccc;
            border-radius: 20px; /* Round corners */
            overflow: hidden;
            background-color: #ffffff;
        }

        /* For print: Remove shadows and borders */
        @media print {
            body {
                background-color: white;
            }
            .poster {
                border: none;
                box-shadow: none;
                width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="poster">
        <!-- Banner with Title/Subtitle on left, Key Image on right -->
        <div class="banner">
            <div class="banner-text">
                <h1 id="title">Event Title</h1>
                <h2 id="subtitle">Event Subtitle</h2>
            </div>
            <div class="banner-image">
                <img id="key-image" src="https://example.com/key-image.jpg" alt="Key Image">
            </div>
        </div>
        
        <!-- Details Box with Icons (no header) -->
        <div class="box details">
            <ul>
                <li id="date-li">üìÖ <strong>Date:</strong> Default Date</li>
                <li id="time-li">üïí <strong>Time:</strong> Default Time</li>
                <li id="location-li">üìç <strong>Location:</strong> Default Location</li>
            </ul>
        </div>
        
        <!-- Description Box with 3 Bullet Points -->
        <div class="box description">
            <h3>Description</h3>
            <ul>
                <li id="desc1">Default Bullet 1</li>
                <li id="desc2">Default Bullet 2</li>
                <li id="desc3">Default Bullet 3</li>
            </ul>
        </div>
        
        <!-- QR Code in Round Corner Box -->
        <div class="qr-box">
            <div id="qr" style="width: 150px; height: 150px;"></div>
        </div>
        
        <!-- Footer Image -->
        <img src="https://www.compassoffices.com/wp-content/uploads/2025/10/poster-footer-1.jpg" alt="Compass Offices Footer" style="position: absolute; bottom: 0; left: 0; width: 100%; height: auto;">
    </div>

    <script>
        // Parse URL parameters
        const params = new URLSearchParams(window.location.search);
        
        // Fill in content with params (or defaults)
        document.getElementById('title').textContent = params.get('title') || 'Event Title';
        document.getElementById('subtitle').textContent = params.get('subtitle') || 'Event Subtitle';
        document.getElementById('key-image').src = params.get('image') || 'https://example.com/key-image.jpg';
        document.getElementById('date-li').innerHTML = 'üìÖ <strong>Date:</strong> ' + (params.get('date') || 'Default Date');
        document.getElementById('time-li').innerHTML = 'üïí <strong>Time:</strong> ' + (params.get('time') || 'Default Time');
        document.getElementById('location-li').innerHTML = 'üìç <strong>Location:</strong> ' + (params.get('location') || 'Default Location');
        document.getElementById('desc1').textContent = params.get('desc1') || 'Default Bullet 1';
        document.getElementById('desc2').textContent = params.get('desc2') || 'Default Bullet 2';
        document.getElementById('desc3').textContent = params.get('desc3') || 'Default Bullet 3';

        // Auto-generate QR Code if qr_url param is provided
        const qrUrl = params.get('qr_url') || 'https://example.com'; // Default to example if not provided
        new QRCode(document.getElementById('qr'), {
            text: qrUrl,
            width: 150,
            height: 150,
            colorDark: '#000000',
            colorLight: '#ffffff'
        });

        // Auto-generate and download JPG on load (after images and QR are ready)
        window.onload = function() {
            setTimeout(() => { // Small delay to ensure QR renders
                html2canvas(document.querySelector('.poster'), {
                    scale: 2, // Higher scale for better quality
                    useCORS: true // Handle cross-origin images
                }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = 'poster.jpg';
                    link.href = canvas.toDataURL('image/jpeg', 0.9); // JPG format, 90% quality
                    link.click();
                }).catch(error => {
                    console.error('Error generating JPG:', error);
                });
            }, 500); // 500ms delay for QR generation
        };
    </script>
</body>
</html>
