<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=410, height=800, initial-scale=1.0" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<meta http-equiv="Cache" content="no-cache" />
<link href="https://fonts.cdnfonts.com/css/neue-haas-grotesk-display-pro" rel="stylesheet" />
<title>Compass Events</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
html { font-size: 12px; }
body {
width: 410px;
height: 800px;
background-color: #000;
color: #fff;
font-family: 'Neue Haas Grotesk Display Pro', sans-serif;
display: flex;
flex-direction: column;
padding: 0 2rem;
overflow: hidden;
position: relative;
}
.header {
margin: 2rem 0;
text-align: left;
font-size: 4.2rem;
line-height: 4.2rem;
}
.header-upcoming { font-weight: 400; }
.header-events { font-weight: 700; }
.event-container {
overflow-y: auto;
flex: 1;
}
.event-card {
width: 100%;
height: 460px;
background-color: #f1f1f1;
border-radius: 1rem;
display: flex;
flex-direction: column;
justify-content: space-between;
color: #000;
margin: 2rem 0;
}
.img-container {
position: relative;
display: flex;
justify-content: center;
overflow: hidden;
border-radius: 1rem 1rem 0 0;
height: 50%;
}
.card-img {
width: 100%;
height: 100%;
object-fit: cover;
}
.date {
position: absolute;
top: 0.75rem;
right: 0.75rem;
font-weight: 600;
font-size: 3.2rem;
line-height: 3.2rem;
color: #fff;
background: linear-gradient(to right, rgba(255, 102, 0, 0.6), rgba(255, 140, 0, 0.3));
backdrop-filter: blur(5px);
-webkit-backdrop-filter: blur(2px);
width: 9rem;
height: 9rem;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
border-radius: 0.5rem;
box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
border: 1px solid rgba(255, 255, 255, 0.2);
}
.event-title {
font-weight: 700;
font-size: 2.6rem;
line-height: 3rem;
padding: 1.5rem;
text-align: left;
display: -webkit-box;
-webkit-line-clamp: 4;
-webkit-box-orient: vertical;
overflow: hidden;
text-overflow: ellipsis;
flex-grow: 1;
}
.event-details {
display: flex;
flex-direction: column;
justify-content: flex-end;
padding-bottom: 1.5rem;
}
.event-time,
.event-location {
font-size: 1.8rem;
line-height: 2.2rem;
text-align: left;
padding: 0 1.5rem;
display: flex;
align-items: center;
}
.event-time { margin-bottom: 1rem; }
.event-location { padding-top: 0.5rem; }
.time-icon,
.location-icon {
margin-right: 0.75rem;
font-size: 1.8rem;
}
.bottom-section {
position: absolute;
bottom: 2rem;
right: 2rem;
}
.qr-follow {
display: flex;
align-items: center;
gap: 5rem;
}
.follow {
font-size: 1.8rem;
line-height: 2.1rem;
color: #fff;
text-align: left;
}
.qr-code img {
width: 100px;
height: 100px;
}
.loading {
color: #aaa;
font-size: 1.8rem;
margin: 2rem 0;
text-align: center;
}
.refresh-link {
position: absolute;
top: 1rem;
right: 1rem;
font-size: 1.2rem;
color: black;
text-decoration: underline;
cursor: pointer;
}
</style>
</head>
<body>
<div class="header">
<span id="header-upcoming" class="header-upcoming">Upcoming </span>
<span class="header-events">Event</span>
</div>
<a class="refresh-link" onclick="window.location.href = window.location.pathname + '?t=' + new Date().getTime();">.</a>
<div id="eventContainer" class="event-container">
<div class="loading">Loading events...</div>
</div>
<div class="bottom-section">
<div class="qr-follow">
<div class="follow">Scan for<br />more details&nbsp;&nbsp;</div>
<div class="qr-code">
<img src="https://cdn.glitch.global/d3825f09-16b9-42c5-aed8-ef674a7a82c1/linkedtre-qr.png?v=1747650115477" alt="QR Code" />
</div>
</div>
</div>
<script>
const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQHHIkS2fCZhbgyTTXuNifmRBxOY4RmDGIZnzEePIYQnZm9dlpMnPHpdGjFoiyMHdKWd023G-xmwSS2/pub?gid=0&single=true&output=csv';
function parseDate(dateStr) {
const parts = dateStr.trim().split('/');
if (parts.length !== 3) return null;
return new Date(parts[2], parts[1] - 1, parts[0]);
}
function formatDateToBox(dateObj) {
const day = ('0' + dateObj.getDate()).slice(-2);
const month = dateObj.toLocaleString('en-GB', { month: 'short' });
return day + '<br>' + month;
}
const today = new Date();
today.setHours(0, 0, 0, 0);
fetch(csvUrl)
.then(res => res.text())
.then(text => {
const rows = text.trim().split('\n').slice(1);
const container = document.getElementById('eventContainer');
let data = [];
rows.forEach(row => {
const cols = row.split(',');
if (cols.length < 7) return;
const rawDate = cols[1].trim();
const dateObj = parseDate(rawDate);
if (!dateObj) return;
const bannerRaw = cols[6];
const cleanBanner = bannerRaw
.replace(/(^"|"$)/g, '') // remove surrounding quotes
.trim()
.replace(/\r?\n|\r/g, ''); // remove line breaks
const event = {
date: dateObj,
time: cols[2].trim(),
client: cols[3].trim(),
subject: cols[4].trim(),
location: cols[5].trim(),
banner: cleanBanner
};
if (dateObj >= today) data.push(event);
});
data.sort((a, b) => a.date - b.date);
const firstEvent = data[0];
if (!firstEvent) {
container.innerHTML = '<div class="loading">No upcoming events found.</div>';
return;
}
container.innerHTML = '';
const card = document.createElement('div');
card.className = 'event-card';
let imgSrc = firstEvent.banner || '';
const img = document.createElement('img');
img.src = imgSrc;
img.alt = 'Event Image';
img.className = 'card-img';
const imgContainer = document.createElement('div');
imgContainer.className = 'img-container';
imgContainer.appendChild(img);
const dateBox = document.createElement('div');
dateBox.className = 'date';
dateBox.innerHTML = formatDateToBox(firstEvent.date);
imgContainer.appendChild(dateBox);
const title = document.createElement('div');
title.className = 'event-title';
title.textContent = firstEvent.subject;
const details = document.createElement('div');
details.className = 'event-details';
const time = document.createElement('div');
time.className = 'event-time';
time.innerHTML = '<span class="time-icon">üïí</span>' + firstEvent.time;
const loc = document.createElement('div');
loc.className = 'event-location';
loc.innerHTML = '<span class="location-icon">üìç</span>' + firstEvent.location;
details.appendChild(time);
details.appendChild(loc);
card.appendChild(imgContainer);
card.appendChild(title);
card.appendChild(details);
container.appendChild(card);
})
.catch(err => {
document.getElementById('eventContainer').innerHTML = '<div class="loading">Failed to load events.</div>';
console.error(err);
});
</script>
</body>
</html>
