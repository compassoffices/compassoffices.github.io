<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=410, height=800, initial-scale=1.0" />
  <link href="https://fonts.cdnfonts.com/css/neue-haas-grotesk-display-pro" rel="stylesheet" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { font-size: 12px; }
    body {
      width: 410px; height: 800px;
      background-color: #000; color: #fff;
      font-family: 'Neue Haas Grotesk Display Pro', sans-serif;
      display: flex; flex-direction: column;
      padding: 0 2rem; overflow-y: auto;
      position: relative;
    }
    .header {
      margin: 2rem 0 1rem 0;
      text-align: left;
      font-size: 4.2rem;
      line-height: 4.2rem;
    }
    .header-upcoming { font-weight: 400; }
    .header-events { font-weight: 700; }
    .slideshow-container {
      position: relative;
      width: 100%;
      height: calc(280px * 2 + 3.5rem);
      overflow: hidden;
    }
    .slide-group {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      opacity: 0;
      transition: opacity 1s ease-in-out;
      display: flex; flex-direction: column;
    }
    .slide-group.active {
      opacity: 1;
      z-index: 1;
    }
    .event-card {
      width: 100%; height: 250px;
      background-color: #f1f1f1;
      border-radius: 1rem;
      display: flex;
      flex-direction: column;
      color: #000;
      overflow: hidden;
      position: relative;
      margin-bottom: 2rem;
    }
    .card-divider {
      height: 0.6px;
      background-color: #000;
      margin: -2.5rem 0 1rem 0;
      border: none;
    }
    .img-container {
      height: 35%;
      width: 100%;
      border-radius: 1rem 1rem 0 0;
      overflow: hidden;
    }
    .card-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .event-title {
      font-weight: 600;
      font-size: 2rem;
      line-height: 2.3rem;
      padding: 0.6rem 1.5rem 0.3rem 1.5rem;
      text-align: left;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      word-break: break-word;
      overflow-wrap: break-word;
      flex-grow: 1;
    }
    .company-name {
      font-size: 1.4rem;
      color: #999;
      padding: 0 1.5rem 0.7rem 1.5rem;
      text-align: left;
    }
    .bottom-section {
      position: absolute;
      bottom: 2rem;
      right: 2rem;
    }
    .qr-follow {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }
    .follow {
      font-size: 1.5rem;
      line-height: 2rem;
      color: #fff;
      text-align: left;
    }
    .qr-code img {
      width: 100px;
      height: 100px;
      margin-left: 2rem;
    }
    .contact-info {
      font-size: 1.3rem;
      color: #ccc;
      margin-top: 0rem;
      text-align: left;
    }
    .text-orange {
      font-size: 1.6rem;
      color: white;
    }
  </style>
</head>
<body>

<!-- Header -->
<div class="header">
  <span class="header-upcoming">Client </span>
  <span class="header-events">Perks</span>
</div>

<!-- Slideshow Container -->
<div class="slideshow-container" id="slideshowContainer"></div>

<div class="contact-info">
  Contact marketing team for more details:<br />
  <p class="text-orange">marketing@compassoffices.com</p>
</div>

<script>
  var SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR5DL0QoJRnBdK-omP5H8mELkFoTTZxSPZm3iOtHmGab7DhL6H6vowB2OAV8JMhxu6Dn8b-HaKGcDTI/pub?gid=685908943&single=true&output=csv";

  function fetchSheetData(callback) {
    fetch(SHEET_CSV_URL)
      .then(response => response.text())
      .then(text => {
        const lines = text.trim().split('\n');
        const data = [];

        for (let i = 1; i < lines.length; i++) {
          const row = lines[i].split(',');
          if (row.length >= 5) {
            const timestamp = row[0].trim();
            const score = row[1].trim();
            const imgUrl = row[2].trim();
            const title = row[3].trim();
            const company = row[4].trim();

            data.push({ timestamp, score, imgUrl, title, company });
          }
        }

        callback(data.reverse().slice(0, 6));
      })
      .catch(error => {
        console.error("Error loading CSV:", error);
      });
  }

  function createSlideGroup(cards) {
    var group = document.createElement("div");
    group.className = "slide-group";

    for (var i = 0; i < cards.length; i++) {
      var card = cards[i];
      var imgSrc = card.imgUrl;

      var cardDiv = document.createElement("div");
      cardDiv.className = "event-card";

      var imgContainer = document.createElement("div");
      imgContainer.className = "img-container";

      var img = document.createElement("img");
      img.src = imgSrc;
      img.alt = "Perk";
      img.className = "card-img";

      imgContainer.appendChild(img);

      var title = document.createElement("div");
      title.className = "event-title";
      title.innerText = card.title;

      var company = document.createElement("div");
      company.className = "company-name";
      company.innerText = card.company;

      cardDiv.appendChild(imgContainer);
      cardDiv.appendChild(title);
      cardDiv.appendChild(company);

      group.appendChild(cardDiv);

      if (i < cards.length - 1) {
        var spacer = document.createElement("div");
        spacer.style.height = "1rem";
        group.appendChild(spacer);

        var divider = document.createElement("div");
        divider.className = "card-divider";
        group.appendChild(divider);
      }
    }

    return group;
  }

  function initSlides() {
    fetchSheetData(function (perks) {
      var container = document.getElementById("slideshowContainer");
      var chunkSize = 2;
      var slides = [];

      for (var i = 0; i < perks.length; i += chunkSize) {
        var chunk = perks.slice(i, i + chunkSize);
        var slide = createSlideGroup(chunk);
        container.appendChild(slide);
        slides.push(slide);
      }

      if (slides.length > 0) {
        slides[0].classList.add("active");
        var current = 0;

        setInterval(function () {
          slides[current].classList.remove("active");
          current = (current + 1) % slides.length;
          slides[current].classList.add("active");
        }, 6000);
      }
    });
  }

  document.addEventListener("DOMContentLoaded", initSlides);
</script>

</body>
</html>
